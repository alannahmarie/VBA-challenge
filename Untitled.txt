' Create a script that will loop through all the stocks for one year and output the following information.' The ticker symbol.' Yearly change from opening price at the beginning of a given year to the closing price at the end of that year.' The percent change from opening price at the beginning of a given year to the closing price at the end of that year.' The total stock volume of the stock.Sub StockMarket()' Apply script to all worksheets in workbookDim WS_Count As IntegerDim ws As IntegerWS_Count = ActiveWorkbook.Worksheets.Count    For ws = 1 To WS_Count        Worksheets(ActiveWorkbook.Worksheets(ws).Name).Activate     ' Add Column LabelsRange("I1") = "Ticker"Range("J1") = "Yearly Change"Range("K1") = "Percent Change"Range("L1") = "Total Stock Volume"' Add Bonus Column LabelsRange("O2") = "Greatest % Increase"Range("O3") = "Greatest % Decrease"Range("O4") = "Greatest Total Volume"Range("P1") = "Ticker"Range("Q1") = "Value"' Autofit Column WidthRange("I1:Q1").EntireColumn.AutoFit' Define variables needed for loop and outputs    Dim Last_Row As Long    Last_Row = Cells(Rows.Count, 2).End(xlUp).Row             Dim Ticker As String        Dim OPrice As Double    OPrice = 0    Dim CPrice As Double    CPrice = 0        Dim Yearly_Change As Double    Yearly_Change = CPrice - OPrice            Dim Percent_Change As Double    Percent_Change = 0        Dim Total_Volume As Long    Total_Volume = 0        Dim Summary_Table_Row As Long    Summary_Table_Row = 2            For i = 2 To Last_Row                        If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then                        ' Locate and output each unique Ticker Symbol                            Ticker = Cells(i, 1).Value                                Range("I" & Summary_Table_Row).Value = Ticker                            ' Calculate and ouput Yearly Change                                OPrice = OPrice + Cells(i, 3).Value                                CPrice = CPrice + Cells(i, 6).Value                                Yearly_Change = CPrice - OPrice                                Range("J" & Summary_Table_Row).Value = Yearly_Change                                    If Yearly_Change >= 0 Then                                        ' Show positive change as green                                            Range("J" & Summary_Table_Row).Interior.ColorIndex = 4                                        Else                                        ' Show negative change as red                                            Range("J" & Summary_Table_Row).Interior.ColorIndex = 3                                            End If                                ' Calculate and output Percent Change                If OPrice <> 0 Then                                Percent_Change = Yearly_Change / OPrice                                    Range("K" & Summary_Table_Row).Value = Percent_Change                                    End If                            ' Calculate and output Total Stock Volume                                Total_Volume = Total_Volume + Cells(i, 7).Value                                Range("L" & Summary_Table_Row).Value = Total_Volume                         OPrice = 0             CPrice = 0             Yearly_Change = 0             Total_Volume = 0                         Summary_Table_Row = Summary_Table_Row + 1                 End If        Next iNext ws    End Sub    